{"version":3,"sources":["featherlight.js"],"names":["factory","define","amd","module","exports","root","jQuery","undefined","window","require","$","fn","jquery","match","console","info","opened","pruneOpened","remove","grep","fl","$instance","closest","length","iFrameAttributeSet","allow","allowfullscreen","frameborder","height","longdesc","marginheight","marginwidth","mozallowfullscreen","name","referrerpolicy","sandbox","scrolling","src","srcdoc","style","webkitallowfullscreen","width","eventMap","keyup","resize","globalEventHandler","event","each","Featherlight","reverse","isDefaultPrevented","this","type","preventDefault","stopPropagation","toggleGlobalEvents","set","_globalHandlerInstalled","events","map","_","prototype","namespace","join","constructor","targetAttr","variant","resetCss","background","openTrigger","closeTrigger","filter","openSpeed","closeSpeed","closeOnClick","closeOnEsc","closeIcon","loading","persist","otherClose","beforeOpen","noop","beforeContent","beforeClose","afterOpen","afterContent","afterClose","onKeyUp","onResize","contentFilters","setup","target","config","self","extend","css","$background","closeButtonSelector","clone","addClass","on","$target","is","close","getContent","$content","filters","readTargetAttr","$currentTarget","attr","targetValue","data","filterName","test","regex","error","process","call","setContent","removeClass","toggleClass","find","not","slice","end","replaceWith","contains","open","hide","appendTo","push","fadeIn","when","always","$openendContent","then","promise","done","detach","Deferred","reject","deferred","fadeOut","resolve","w","h","ratio","Math","max","parent","floor","chainCallbacks","chain","proxy","id","autoBind","defaults","elem","image","url","img","Image","$img","onload","naturalWidth","naturalHeight","onerror","html","ajax","$container","load","response","status","contents","iframe","obj","prefix","attrs","RegExp","key","replace","toLowerCase","parseAttrs","r","show","text","functionAttributes","readElementConfig","element","Klass","regexp","attributes","val","value","camelCase","inArray","Function","JSON","parse","e","child","Ctor","__super__","attach","$source","sharedPersist","tempConfig","handler","currentTarget","elemConfig","blur","current","all","klass","cur","_onReady","$autobound","document","evt","$cur","add","parentsUntil","_callbackChain","_super","keyCode","featherlight","documentElement","_previouslyActive","activeElement","_$previouslyTabbable","_$previouslyWithTabIndex","_previousWithTabIndices","_i","removeAttr","i","focus","ready"],"mappings":"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","file":"featherlight.js","sourcesContent":["/**\n * Featherlight - ultra slim jQuery lightbox\n * Version 1.7.14-UMD - http://noelboss.github.io/featherlight/\n *\n * Copyright 2019, Noël Raoul Bossart (http://www.noelboss.com)\n * MIT Licensed.\n**/\n(function (factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\t// AMD. Register as an anonymous module.\n\t\tdefine(['jquery'], factory);\n\t} else if (typeof module === 'object' && module.exports) {\n\t\t// Node/CommonJS\n\t\tmodule.exports = function (root, jQuery) {\n\t\t\tif (jQuery === undefined) {\n\t\t\t\t// require('jQuery') returns a factory that requires window to\n\t\t\t\t// build a jQuery instance, we normalize how we use modules\n\t\t\t\t// that require this pattern but the window provided is a noop\n\t\t\t\t// if it's defined (how jquery works)\n\t\t\t\tif (typeof window !== 'undefined') {\n\t\t\t\t\tjQuery = require('jquery');\n\t\t\t\t} else {\n\t\t\t\t\tjQuery = require('jquery')(root);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfactory(jQuery);\n\t\t\treturn jQuery;\n\t\t};\n\t} else {\n\t\t// Browser globals\n\t\tfactory(jQuery);\n\t}\n})(function($) {\n\t\"use strict\";\n\n\tif('undefined' === typeof $) {\n\t\tif('console' in window){ window.console.info('Too much lightness, Featherlight needs jQuery.'); }\n\t\treturn;\n\t}\n\tif($.fn.jquery.match(/-ajax/)) {\n\t\tif('console' in window){ window.console.info('Featherlight needs regular jQuery, not the slim version.'); }\n\t\treturn;\n\t}\n\t/* Featherlight is exported as $.featherlight.\n\t   It is a function used to open a featherlight lightbox.\n\n\t   [tech]\n\t   Featherlight uses prototype inheritance.\n\t   Each opened lightbox will have a corresponding object.\n\t   That object may have some attributes that override the\n\t   prototype's.\n\t   Extensions created with Featherlight.extend will have their\n\t   own prototype that inherits from Featherlight's prototype,\n\t   thus attributes can be overriden either at the object level,\n\t   or at the extension level.\n\t   To create callbacks that chain themselves instead of overriding,\n\t   use chainCallbacks.\n\t   For those familiar with CoffeeScript, this correspond to\n\t   Featherlight being a class and the Gallery being a class\n\t   extending Featherlight.\n\t   The chainCallbacks is used since we don't have access to\n\t   CoffeeScript's `super`.\n\t*/\n\n\tfunction Featherlight($content, config) {\n\t\tif(this instanceof Featherlight) {  /* called with new */\n\t\t\tthis.id = Featherlight.id++;\n\t\t\tthis.setup($content, config);\n\t\t\tthis.chainCallbacks(Featherlight._callbackChain);\n\t\t} else {\n\t\t\tvar fl = new Featherlight($content, config);\n\t\t\tfl.open();\n\t\t\treturn fl;\n\t\t}\n\t}\n\n\tvar opened = [],\n\t\tpruneOpened = function(remove) {\n\t\t\topened = $.grep(opened, function(fl) {\n\t\t\t\treturn fl !== remove && fl.$instance.closest('body').length > 0;\n\t\t\t} );\n\t\t\treturn opened;\n\t\t};\n\n\t// Removes keys of `set` from `obj` and returns the removed key/values.\n\tfunction slice(obj, set) {\n\t\tvar r = {};\n\t\tfor (var key in obj) {\n\t\t\tif (key in set) {\n\t\t\t\tr[key] = obj[key];\n\t\t\t\tdelete obj[key];\n\t\t\t}\n\t\t}\n\t\treturn r;\n\t}\n\n\t// NOTE: List of available [iframe attributes](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe).\n\tvar iFrameAttributeSet = {\n\t\tallow: 1, allowfullscreen: 1, frameborder: 1, height: 1, longdesc: 1, marginheight: 1, marginwidth: 1,\n\t\tmozallowfullscreen: 1, name: 1, referrerpolicy: 1, sandbox: 1, scrolling: 1, src: 1, srcdoc: 1, style: 1,\n\t\twebkitallowfullscreen: 1, width: 1\n\t};\n\n\t// Converts camelCased attributes to dasherized versions for given prefix:\n\t//   parseAttrs({hello: 1, hellFrozeOver: 2}, 'hell') => {froze-over: 2}\n\tfunction parseAttrs(obj, prefix) {\n\t\tvar attrs = {},\n\t\t\tregex = new RegExp('^' + prefix + '([A-Z])(.*)');\n\t\tfor (var key in obj) {\n\t\t\tvar match = key.match(regex);\n\t\t\tif (match) {\n\t\t\t\tvar dasherized = (match[1] + match[2].replace(/([A-Z])/g, '-$1')).toLowerCase();\n\t\t\t\tattrs[dasherized] = obj[key];\n\t\t\t}\n\t\t}\n\t\treturn attrs;\n\t}\n\n\t/* document wide key handler */\n\tvar eventMap = { keyup: 'onKeyUp', resize: 'onResize' };\n\n\tvar globalEventHandler = function(event) {\n\t\t$.each(Featherlight.opened().reverse(), function() {\n\t\t\tif (!event.isDefaultPrevented()) {\n\t\t\t\tif (false === this[eventMap[event.type]](event)) {\n\t\t\t\t\tevent.preventDefault(); event.stopPropagation(); return false;\n\t\t\t  }\n\t\t\t}\n\t\t});\n\t};\n\n\tvar toggleGlobalEvents = function(set) {\n\t\t\tif(set !== Featherlight._globalHandlerInstalled) {\n\t\t\t\tFeatherlight._globalHandlerInstalled = set;\n\t\t\t\tvar events = $.map(eventMap, function(_, name) { return name+'.'+Featherlight.prototype.namespace; } ).join(' ');\n\t\t\t\t$(window)[set ? 'on' : 'off'](events, globalEventHandler);\n\t\t\t}\n\t\t};\n\n\tFeatherlight.prototype = {\n\t\tconstructor: Featherlight,\n\t\t/*** defaults ***/\n\t\t/* extend featherlight with defaults and methods */\n\t\tnamespace:      'featherlight',        /* Name of the events and css class prefix */\n\t\ttargetAttr:     'data-featherlight',   /* Attribute of the triggered element that contains the selector to the lightbox content */\n\t\tvariant:        null,                  /* Class that will be added to change look of the lightbox */\n\t\tresetCss:       false,                 /* Reset all css */\n\t\tbackground:     null,                  /* Custom DOM for the background, wrapper and the closebutton */\n\t\topenTrigger:    'click',               /* Event that triggers the lightbox */\n\t\tcloseTrigger:   'click',               /* Event that triggers the closing of the lightbox */\n\t\tfilter:         null,                  /* Selector to filter events. Think $(...).on('click', filter, eventHandler) */\n\t\troot:           'body',                /* Where to append featherlights */\n\t\topenSpeed:      250,                   /* Duration of opening animation */\n\t\tcloseSpeed:     250,                   /* Duration of closing animation */\n\t\tcloseOnClick:   'background',          /* Close lightbox on click ('background', 'anywhere' or false) */\n\t\tcloseOnEsc:     true,                  /* Close lightbox when pressing esc */\n\t\tcloseIcon:      '&#10005;',            /* Close icon */\n\t\tloading:        '',                    /* Content to show while initial content is loading */\n\t\tpersist:        false,                 /* If set, the content will persist and will be shown again when opened again. 'shared' is a special value when binding multiple elements for them to share the same content */\n\t\totherClose:     null,                  /* Selector for alternate close buttons (e.g. \"a.close\") */\n\t\tbeforeOpen:     $.noop,                /* Called before open. can return false to prevent opening of lightbox. Gets event as parameter, this contains all data */\n\t\tbeforeContent:  $.noop,                /* Called when content is loaded. Gets event as parameter, this contains all data */\n\t\tbeforeClose:    $.noop,                /* Called before close. can return false to prevent closing of lightbox. Gets event as parameter, this contains all data */\n\t\tafterOpen:      $.noop,                /* Called after open. Gets event as parameter, this contains all data */\n\t\tafterContent:   $.noop,                /* Called after content is ready and has been set. Gets event as parameter, this contains all data */\n\t\tafterClose:     $.noop,                /* Called after close. Gets event as parameter, this contains all data */\n\t\tonKeyUp:        $.noop,                /* Called on key up for the frontmost featherlight */\n\t\tonResize:       $.noop,                /* Called after new content and when a window is resized */\n\t\ttype:           null,                  /* Specify type of lightbox. If unset, it will check for the targetAttrs value. */\n\t\tcontentFilters: ['jquery', 'image', 'html', 'ajax', 'iframe', 'text'], /* List of content filters to use to determine the content */\n\n\t\t/*** methods ***/\n\t\t/* setup iterates over a single instance of featherlight and prepares the background and binds the events */\n\t\tsetup: function(target, config){\n\t\t\t/* all arguments are optional */\n\t\t\tif (typeof target === 'object' && target instanceof $ === false && !config) {\n\t\t\t\tconfig = target;\n\t\t\t\ttarget = undefined;\n\t\t\t}\n\n\t\t\tvar self = $.extend(this, config, {target: target}),\n\t\t\t\tcss = !self.resetCss ? self.namespace : self.namespace+'-reset', /* by adding -reset to the classname, we reset all the default css */\n\t\t\t\t$background = $(self.background || [\n\t\t\t\t\t'<div class=\"'+css+'-loading '+css+'\">',\n\t\t\t\t\t\t'<div class=\"'+css+'-content\">',\n\t\t\t\t\t\t\t'<button class=\"'+css+'-close-icon '+ self.namespace + '-close\" aria-label=\"Close\">',\n\t\t\t\t\t\t\t\tself.closeIcon,\n\t\t\t\t\t\t\t'</button>',\n\t\t\t\t\t\t\t'<div class=\"'+self.namespace+'-inner\">' + self.loading + '</div>',\n\t\t\t\t\t\t'</div>',\n\t\t\t\t\t'</div>'].join('')),\n\t\t\t\tcloseButtonSelector = '.'+self.namespace+'-close' + (self.otherClose ? ',' + self.otherClose : '');\n\n\t\t\tself.$instance = $background.clone().addClass(self.variant); /* clone DOM for the background, wrapper and the close button */\n\n\t\t\t/* close when click on background/anywhere/null or closebox */\n\t\t\tself.$instance.on(self.closeTrigger+'.'+self.namespace, function(event) {\n\t\t\t\tif(event.isDefaultPrevented()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar $target = $(event.target);\n\t\t\t\tif( ('background' === self.closeOnClick  && $target.is('.'+self.namespace))\n\t\t\t\t\t|| 'anywhere' === self.closeOnClick\n\t\t\t\t\t|| $target.closest(closeButtonSelector).length ){\n\t\t\t\t\tself.close(event);\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn this;\n\t\t},\n\n\t\t/* this method prepares the content and converts it into a jQuery object or a promise */\n\t\tgetContent: function(){\n\t\t\tif(this.persist !== false && this.$content) {\n\t\t\t\treturn this.$content;\n\t\t\t}\n\t\t\tvar self = this,\n\t\t\t\tfilters = this.constructor.contentFilters,\n\t\t\t\treadTargetAttr = function(name){ return self.$currentTarget && self.$currentTarget.attr(name); },\n\t\t\t\ttargetValue = readTargetAttr(self.targetAttr),\n\t\t\t\tdata = self.target || targetValue || '';\n\n\t\t\t/* Find which filter applies */\n\t\t\tvar filter = filters[self.type]; /* check explicit type like {type: 'image'} */\n\n\t\t\t/* check explicit type like data-featherlight=\"image\" */\n\t\t\tif(!filter && data in filters) {\n\t\t\t\tfilter = filters[data];\n\t\t\t\tdata = self.target && targetValue;\n\t\t\t}\n\t\t\tdata = data || readTargetAttr('href') || '';\n\n\t\t\t/* check explicity type & content like {image: 'photo.jpg'} */\n\t\t\tif(!filter) {\n\t\t\t\tfor(var filterName in filters) {\n\t\t\t\t\tif(self[filterName]) {\n\t\t\t\t\t\tfilter = filters[filterName];\n\t\t\t\t\t\tdata = self[filterName];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/* otherwise it's implicit, run checks */\n\t\t\tif(!filter) {\n\t\t\t\tvar target = data;\n\t\t\t\tdata = null;\n\t\t\t\t$.each(self.contentFilters, function() {\n\t\t\t\t\tfilter = filters[this];\n\t\t\t\t\tif(filter.test)  {\n\t\t\t\t\t\tdata = filter.test(target);\n\t\t\t\t\t}\n\t\t\t\t\tif(!data && filter.regex && target.match && target.match(filter.regex)) {\n\t\t\t\t\t\tdata = target;\n\t\t\t\t\t}\n\t\t\t\t\treturn !data;\n\t\t\t\t});\n\t\t\t\tif(!data) {\n\t\t\t\t\tif('console' in window){ window.console.error('Featherlight: no content filter found ' + (target ? ' for \"' + target + '\"' : ' (no target specified)')); }\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t/* Process it */\n\t\t\treturn filter.process.call(self, data);\n\t\t},\n\n\t\t/* sets the content of $instance to $content */\n\t\tsetContent: function($content){\n      this.$instance.removeClass(this.namespace+'-loading');\n\n      /* we need a special class for the iframe */\n      this.$instance.toggleClass(this.namespace+'-iframe', $content.is('iframe'));\n\n      /* replace content by appending to existing one before it is removed\n         this insures that featherlight-inner remain at the same relative\n         position to any other items added to featherlight-content */\n      this.$instance.find('.'+this.namespace+'-inner')\n        .not($content)                /* excluded new content, important if persisted */\n        .slice(1).remove().end()      /* In the unexpected event where there are many inner elements, remove all but the first one */\n        .replaceWith($.contains(this.$instance[0], $content[0]) ? '' : $content);\n\n      this.$content = $content.addClass(this.namespace+'-inner');\n\n      return this;\n\t\t},\n\n\t\t/* opens the lightbox. \"this\" contains $instance with the lightbox, and with the config.\n\t\t\tReturns a promise that is resolved after is successfully opened. */\n\t\topen: function(event){\n\t\t\tvar self = this;\n\t\t\tself.$instance.hide().appendTo(self.root);\n\t\t\tif((!event || !event.isDefaultPrevented())\n\t\t\t\t&& self.beforeOpen(event) !== false) {\n\n\t\t\t\tif(event){\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\tvar $content = self.getContent();\n\n\t\t\t\tif($content) {\n\t\t\t\t\topened.push(self);\n\n\t\t\t\t\ttoggleGlobalEvents(true);\n\n\t\t\t\t\tself.$instance.fadeIn(self.openSpeed);\n\t\t\t\t\tself.beforeContent(event);\n\n\t\t\t\t\t/* Set content and show */\n\t\t\t\t\treturn $.when($content)\n\t\t\t\t\t\t.always(function($openendContent){\n\t\t\t\t\t\t\tif($openendContent) {\n\t\t\t\t\t\t\t\tself.setContent($openendContent);\n\t\t\t\t\t\t\t\tself.afterContent(event);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(self.$instance.promise())\n\t\t\t\t\t\t/* Call afterOpen after fadeIn is done */\n\t\t\t\t\t\t.done(function(){ self.afterOpen(event); });\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.$instance.detach();\n\t\t\treturn $.Deferred().reject().promise();\n\t\t},\n\n\t\t/* closes the lightbox. \"this\" contains $instance with the lightbox, and with the config\n\t\t\treturns a promise, resolved after the lightbox is successfully closed. */\n\t\tclose: function(event){\n\t\t\tvar self = this,\n\t\t\t\tdeferred = $.Deferred();\n\n\t\t\tif(self.beforeClose(event) === false) {\n\t\t\t\tdeferred.reject();\n\t\t\t} else {\n\n\t\t\t\tif (0 === pruneOpened(self).length) {\n\t\t\t\t\ttoggleGlobalEvents(false);\n\t\t\t\t}\n\n\t\t\t\tself.$instance.fadeOut(self.closeSpeed,function(){\n\t\t\t\t\tself.$instance.detach();\n\t\t\t\t\tself.afterClose(event);\n\t\t\t\t\tdeferred.resolve();\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn deferred.promise();\n\t\t},\n\n\t\t/* resizes the content so it fits in visible area and keeps the same aspect ratio.\n\t\t\t\tDoes nothing if either the width or the height is not specified.\n\t\t\t\tCalled automatically on window resize.\n\t\t\t\tOverride if you want different behavior. */\n\t\tresize: function(w, h) {\n\t\t\tif (w && h) {\n\t\t\t\t/* Reset apparent image size first so container grows */\n\t\t\t\tthis.$content.css('width', '').css('height', '');\n\t\t\t\t/* Calculate the worst ratio so that dimensions fit */\n\t\t\t\t /* Note: -1 to avoid rounding errors */\n\t\t\t\tvar ratio = Math.max(\n\t\t\t\t\tw  / (this.$content.parent().width()-1),\n\t\t\t\t\th / (this.$content.parent().height()-1));\n\t\t\t\t/* Resize content */\n\t\t\t\tif (ratio > 1) {\n\t\t\t\t\tratio = h / Math.floor(h / ratio); /* Round ratio down so height calc works */\n\t\t\t\t\tthis.$content.css('width', '' + w / ratio + 'px').css('height', '' + h / ratio + 'px');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/* Utility function to chain callbacks\n\t\t   [Warning: guru-level]\n\t\t   Used be extensions that want to let users specify callbacks but\n\t\t   also need themselves to use the callbacks.\n\t\t   The argument 'chain' has callback names as keys and function(super, event)\n\t\t   as values. That function is meant to call `super` at some point.\n\t\t*/\n\t\tchainCallbacks: function(chain) {\n\t\t\tfor (var name in chain) {\n\t\t\t\tthis[name] = $.proxy(chain[name], this, $.proxy(this[name], this));\n\t\t\t}\n\t\t}\n\t};\n\n\t$.extend(Featherlight, {\n\t\tid: 0,                                    /* Used to id single featherlight instances */\n\t\tautoBind:       '[data-featherlight]',    /* Will automatically bind elements matching this selector. Clear or set before onReady */\n\t\tdefaults:       Featherlight.prototype,   /* You can access and override all defaults using $.featherlight.defaults, which is just a synonym for $.featherlight.prototype */\n\t\t/* Contains the logic to determine content */\n\t\tcontentFilters: {\n\t\t\tjquery: {\n\t\t\t\tregex: /^[#.]\\w/,         /* Anything that starts with a class name or identifiers */\n\t\t\t\ttest: function(elem)    { return elem instanceof $ && elem; },\n\t\t\t\tprocess: function(elem) { return this.persist !== false ? $(elem) : $(elem).clone(true); }\n\t\t\t},\n\t\t\timage: {\n\t\t\t\tregex: /\\.(png|jpg|jpeg|gif|tiff?|bmp|svg)(\\?\\S*)?$/i,\n\t\t\t\tprocess: function(url)  {\n\t\t\t\t\tvar self = this,\n\t\t\t\t\t\tdeferred = $.Deferred(),\n\t\t\t\t\t\timg = new Image(),\n\t\t\t\t\t\t$img = $('<img src=\"'+url+'\" alt=\"\" class=\"'+self.namespace+'-image\" />');\n\t\t\t\t\timg.onload  = function() {\n\t\t\t\t\t\t/* Store naturalWidth & height for IE8 */\n\t\t\t\t\t\t$img.naturalWidth = img.width; $img.naturalHeight = img.height;\n\t\t\t\t\t\tdeferred.resolve( $img );\n\t\t\t\t\t};\n\t\t\t\t\timg.onerror = function() { deferred.reject($img); };\n\t\t\t\t\timg.src = url;\n\t\t\t\t\treturn deferred.promise();\n\t\t\t\t}\n\t\t\t},\n\t\t\thtml: {\n\t\t\t\tregex: /^\\s*<[\\w!][^<]*>/, /* Anything that starts with some kind of valid tag */\n\t\t\t\tprocess: function(html) { return $(html); }\n\t\t\t},\n\t\t\tajax: {\n\t\t\t\tregex: /./,            /* At this point, any content is assumed to be an URL */\n\t\t\t\tprocess: function(url)  {\n\t\t\t\t\tvar self = this,\n\t\t\t\t\t\tdeferred = $.Deferred();\n\t\t\t\t\t/* we are using load so one can specify a target with: url.html #targetelement */\n\t\t\t\t\tvar $container = $('<div></div>').load(url, function(response, status){\n\t\t\t\t\t\tif ( status !== \"error\" ) {\n\t\t\t\t\t\t\tdeferred.resolve($container.contents());\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdeferred.reject();\n\t\t\t\t\t});\n\t\t\t\t\treturn deferred.promise();\n\t\t\t\t}\n\t\t\t},\n\t\t\tiframe: {\n\t\t\t\tprocess: function(url) {\n\t\t\t\t\tvar deferred = new $.Deferred();\n\t\t\t\t\tvar $content = $('<iframe/>');\n\t\t\t\t\tvar css = parseAttrs(this, 'iframe');\n\t\t\t\t\tvar attrs = slice(css, iFrameAttributeSet);\n\t\t\t\t\t$content.hide()\n\t\t\t\t\t\t.attr('src', url)\n\t\t\t\t\t\t.attr(attrs)\n\t\t\t\t\t\t.css(css)\n\t\t\t\t\t\t.on('load', function() { deferred.resolve($content.show()); })\n\t\t\t\t\t\t// We can't move an <iframe> and avoid reloading it,\n\t\t\t\t\t\t// so let's put it in place ourselves right now:\n\t\t\t\t\t\t.appendTo(this.$instance.find('.' + this.namespace + '-content'));\n\t\t\t\t\treturn deferred.promise();\n\t\t\t\t}\n\t\t\t},\n\t\t\ttext: {\n\t\t\t\tprocess: function(text) { return $('<div>', {text: text}); }\n\t\t\t}\n\t\t},\n\n\t\tfunctionAttributes: ['beforeOpen', 'afterOpen', 'beforeContent', 'afterContent', 'beforeClose', 'afterClose'],\n\n\t\t/*** class methods ***/\n\t\t/* read element's attributes starting with data-featherlight- */\n\t\treadElementConfig: function(element, namespace) {\n\t\t\tvar Klass = this,\n\t\t\t\tregexp = new RegExp('^data-' + namespace + '-(.*)'),\n\t\t\t\tconfig = {};\n\t\t\tif (element && element.attributes) {\n\t\t\t\t$.each(element.attributes, function(){\n\t\t\t\t\tvar match = this.name.match(regexp);\n\t\t\t\t\tif (match) {\n\t\t\t\t\t\tvar val = this.value,\n\t\t\t\t\t\t\tname = $.camelCase(match[1]);\n\t\t\t\t\t\tif ($.inArray(name, Klass.functionAttributes) >= 0) {  /* jshint -W054 */\n\t\t\t\t\t\t\tval = new Function(val);                           /* jshint +W054 */\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttry { val = JSON.parse(val); }\n\t\t\t\t\t\t\tcatch(e) {}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconfig[name] = val;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn config;\n\t\t},\n\n\t\t/* Used to create a Featherlight extension\n\t\t   [Warning: guru-level]\n\t\t   Creates the extension's prototype that in turn\n\t\t   inherits Featherlight's prototype.\n\t\t   Could be used to extend an extension too...\n\t\t   This is pretty high level wizardy, it comes pretty much straight\n\t\t   from CoffeeScript and won't teach you anything about Featherlight\n\t\t   as it's not really specific to this library.\n\t\t   My suggestion: move along and keep your sanity.\n\t\t*/\n\t\textend: function(child, defaults) {\n\t\t\t/* Setup class hierarchy, adapted from CoffeeScript */\n\t\t\tvar Ctor = function(){ this.constructor = child; };\n\t\t\tCtor.prototype = this.prototype;\n\t\t\tchild.prototype = new Ctor();\n\t\t\tchild.__super__ = this.prototype;\n\t\t\t/* Copy class methods & attributes */\n\t\t\t$.extend(child, this, defaults);\n\t\t\tchild.defaults = child.prototype;\n\t\t\treturn child;\n\t\t},\n\n\t\tattach: function($source, $content, config) {\n\t\t\tvar Klass = this;\n\t\t\tif (typeof $content === 'object' && $content instanceof $ === false && !config) {\n\t\t\t\tconfig = $content;\n\t\t\t\t$content = undefined;\n\t\t\t}\n\t\t\t/* make a copy */\n\t\t\tconfig = $.extend({}, config);\n\n\t\t\t/* Only for openTrigger, filter & namespace... */\n\t\t\tvar namespace = config.namespace || Klass.defaults.namespace,\n\t\t\t\ttempConfig = $.extend({}, Klass.defaults, Klass.readElementConfig($source[0], namespace), config),\n\t\t\t\tsharedPersist;\n\t\t\tvar handler = function(event) {\n\t\t\t\tvar $target = $(event.currentTarget);\n\t\t\t\t/* ... since we might as well compute the config on the actual target */\n\t\t\t\tvar elemConfig = $.extend(\n\t\t\t\t\t{$source: $source, $currentTarget: $target},\n\t\t\t\t\tKlass.readElementConfig($source[0], tempConfig.namespace),\n\t\t\t\t\tKlass.readElementConfig(event.currentTarget, tempConfig.namespace),\n\t\t\t\t\tconfig);\n\t\t\t\tvar fl = sharedPersist || $target.data('featherlight-persisted') || new Klass($content, elemConfig);\n\t\t\t\tif(fl.persist === 'shared') {\n\t\t\t\t\tsharedPersist = fl;\n\t\t\t\t} else if(fl.persist !== false) {\n\t\t\t\t\t$target.data('featherlight-persisted', fl);\n\t\t\t\t}\n\t\t\t\tif (elemConfig.$currentTarget.blur) {\n\t\t\t\t\telemConfig.$currentTarget.blur(); // Otherwise 'enter' key might trigger the dialog again\n\t\t\t\t}\n\t\t\t\tfl.open(event);\n\t\t\t};\n\n\t\t\t$source.on(tempConfig.openTrigger+'.'+tempConfig.namespace, tempConfig.filter, handler);\n\n\t\t\treturn {filter: tempConfig.filter, handler: handler};\n\t\t},\n\n\t\tcurrent: function() {\n\t\t\tvar all = this.opened();\n\t\t\treturn all[all.length - 1] || null;\n\t\t},\n\n\t\topened: function() {\n\t\t\tvar klass = this;\n\t\t\tpruneOpened();\n\t\t\treturn $.grep(opened, function(fl) { return fl instanceof klass; } );\n\t\t},\n\n\t\tclose: function(event) {\n\t\t\tvar cur = this.current();\n\t\t\tif(cur) { return cur.close(event); }\n\t\t},\n\n\t\t/* Does the auto binding on startup.\n\t\t   Meant only to be used by Featherlight and its extensions\n\t\t*/\n\t\t_onReady: function() {\n\t\t\tvar Klass = this;\n\t\t\tif(Klass.autoBind){\n\t\t\t\tvar $autobound = $(Klass.autoBind);\n\t\t\t\t/* Bind existing elements */\n\t\t\t\t$autobound.each(function(){\n\t\t\t\t\tKlass.attach($(this));\n\t\t\t\t});\n\t\t\t\t/* If a click propagates to the document level, then we have an item that was added later on */\n\t\t\t\t$(document).on('click', Klass.autoBind, function(evt) {\n\t\t\t\t\tif (evt.isDefaultPrevented()) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar $cur = $(evt.currentTarget);\n\t\t\t\t\tvar len = $autobound.length;\n\t\t\t\t\t$autobound = $autobound.add($cur);\n\t\t\t\t\tif(len === $autobound.length) {\n\t\t\t\t\t\treturn; /* already bound */\n\t\t\t\t\t}\n\t\t\t\t\t/* Bind featherlight */\n\t\t\t\t\tvar data = Klass.attach($cur);\n\t\t\t\t\t/* Dispatch event directly */\n\t\t\t\t\tif (!data.filter || $(evt.target).parentsUntil($cur, data.filter).length > 0) {\n\t\t\t\t\t\tdata.handler(evt);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\t/* Featherlight uses the onKeyUp callback to intercept the escape key.\n\t\t   Private to Featherlight.\n\t\t*/\n\t\t_callbackChain: {\n\t\t\tonKeyUp: function(_super, event){\n\t\t\t\tif(27 === event.keyCode) {\n\t\t\t\t\tif (this.closeOnEsc) {\n\t\t\t\t\t\t$.featherlight.close(event);\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t} else {\n\t\t\t\t\treturn _super(event);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tbeforeOpen: function(_super, event) {\n\t\t\t\t// Used to disable scrolling\n\t\t\t\t$(document.documentElement).addClass('with-featherlight');\n\n\t\t\t\t// Remember focus:\n\t\t\t\tthis._previouslyActive = document.activeElement;\n\n\t\t\t\t// Disable tabbing:\n\t\t\t\t// See http://stackoverflow.com/questions/1599660/which-html-elements-can-receive-focus\n\t\t\t\tthis._$previouslyTabbable = $(\"a, input, select, textarea, iframe, button, iframe, [contentEditable=true]\")\n\t\t\t\t\t.not('[tabindex]')\n\t\t\t\t\t.not(this.$instance.find('button'));\n\n\t\t\t\tthis._$previouslyWithTabIndex = $('[tabindex]').not('[tabindex=\"-1\"]');\n\t\t\t\tthis._previousWithTabIndices = this._$previouslyWithTabIndex.map(function(_i, elem) {\n\t\t\t\t\treturn $(elem).attr('tabindex');\n\t\t\t\t});\n\n\t\t\t\tthis._$previouslyWithTabIndex.add(this._$previouslyTabbable).attr('tabindex', -1);\n\n\t\t\t\tif (document.activeElement.blur) {\n\t\t\t\t\tdocument.activeElement.blur();\n\t\t\t\t}\n\t\t\t\treturn _super(event);\n\t\t\t},\n\n\t\t\tafterClose: function(_super, event) {\n\t\t\t\tvar r = _super(event);\n\t\t\t\t// Restore focus\n\t\t\t\tvar self = this;\n\t\t\t\tthis._$previouslyTabbable.removeAttr('tabindex');\n\t\t\t\tthis._$previouslyWithTabIndex.each(function(i, elem) {\n\t\t\t\t\t$(elem).attr('tabindex', self._previousWithTabIndices[i]);\n\t\t\t\t});\n\t\t\t\tthis._previouslyActive.focus();\n\t\t\t\t// Restore scroll\n\t\t\t\tif(Featherlight.opened().length === 0) {\n\t\t\t\t\t$(document.documentElement).removeClass('with-featherlight');\n\t\t\t\t}\n\t\t\t\treturn r;\n\t\t\t},\n\n\t\t\tonResize: function(_super, event){\n\t\t\t\tthis.resize(this.$content.naturalWidth, this.$content.naturalHeight);\n\t\t\t\treturn _super(event);\n\t\t\t},\n\n\t\t\tafterContent: function(_super, event){\n\t\t\t\tvar r = _super(event);\n\t\t\t\tthis.$instance.find('[autofocus]:not([disabled])').focus();\n\t\t\t\tthis.onResize(event);\n\t\t\t\treturn r;\n\t\t\t}\n\t\t}\n\t});\n\n\t$.featherlight = Featherlight;\n\n\t/* bind jQuery elements to trigger featherlight */\n\t$.fn.featherlight = function($content, config) {\n\t\tFeatherlight.attach(this, $content, config);\n\t\treturn this;\n\t};\n\n\t/* bind featherlight on ready if config autoBind is set */\n\t$(document).ready(function(){ Featherlight._onReady(); });\n});\n"]}